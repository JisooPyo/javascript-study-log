/**
 * ============================================================
 * JavaScript의 this - 1
 * ============================================================
 *
 * this란?
 * - this는 "자신이 속한 객체"를 가리키는 키워드이다.
 * - 자바스크립트의 this는 "어디에서 정의되었는가"가 아니라 "어떻게 호출되었는가"에 따라 값이 결정된다.
 *   즉, this는 정적으로 고정되지 않고 호출 방식에 따라 동적으로 바인딩된다.
 *
 * ------------------------------------------------------------
 * 함수 호출 방식 (총 4가지)
 * ------------------------------------------------------------
 * 1. 일반 함수 호출
 * 2. 메서드 호출
 * 3. 생성자 함수 호출
 * 4. 콜백 함수 호출
 *
 * 이번 코드에서는
 * 1. 일반 함수 호출
 * 2. 메서드 호출
 * 에서 this가 무엇을 가리키는지 살펴본다.
 *
 * 3, 4는 다음 강의에서 다룬다.
 */

/* ============================================================
 * 전역 공간에서의 this
 * ============================================================
 */

// 브라우저 환경에서 전역 공간의 this는 window 객체를 가리킨다.
// (Node.js 환경에서는 global 객체가 출력된다.)
console.log(this); // window (브라우저)

/* ============================================================
 * 1. 일반 함수 호출
 * ============================================================
 */

function func() {
  /**
   * 일반 함수 호출에서의 this
   *
   * - 함수가 "객체에 속하지 않고" 단독으로 호출되면
   *   this는 전역 객체를 가리킨다.
   * - 브라우저 환경: window
   */
  console.log(this);
}

// 일반 함수 호출
func(); // window

/* ============================================================
 * 2. 메서드 호출
 * ============================================================
 *
 * 메서드란?
 * - 객체의 프로퍼티로 존재하는 함수
 * - 메서드 호출 시 this는 "해당 메서드를 호출한 객체"를 가리킨다.
 */

const cafe = {
  brand: "이디야",
  menu: "아메리카노",

  /**
   * print 메서드
   * - 호출 주체는 cafe 객체. this는 cafe를 가리킨다.
   */
  print: function () {
    console.log(this);
  },

  /**
   * 중첩 객체 안의 메서드
   */
  newCafe: {
    brand: "이디야",
    menu: "라떼",

    /**
     * 호출 주체는 newCafe 객체. this는 newCafe를 가리킨다.
     */
    print: function () {
      console.log(this);
    },
  },
};

// 메서드 호출 → this === cafe
cafe.print(); // { brand: "이디야", menu: "아메리카노", ... }

// 중첩 객체의 메서드 호출 → this === newCafe
cafe.newCafe.print(); // { brand: "이디야", menu: "라떼", ... }

/* ============================================================
 * 메서드를 변수에 할당한 경우
 * ============================================================
 */

/**
 * cafe.print 메서드를 변수에 할당
 * - 이 순간 "메서드"가 아니라
 *   단순한 함수 참조가 된다.
 */
const myCafe = cafe.print;

/**
 * 일반 함수 호출 형태로 실행됨
 * → this는 전역 객체(window)를 가리킨다.
 */
myCafe(); // window

// this는 함수가 "어디에 정의되었는지"가 아니라 "어떻게 호출되었는지"에 따라 결정된다.
